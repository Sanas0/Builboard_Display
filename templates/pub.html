{% extends 'layout.html' %}
<title>Pub</title>
<link href="{{url_for('static', filename = 'css/bootstrap.min.css')}}" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css"/>
{% block content %}
   <hr><br>
   <div class="container">
      <div class="row">
         <div class="col md-12">
            <h2>Pub List <button type="button" class="btn btn-success  pull-centre" onclick="window.location.href='/facturation'">Facturation</button>
               <button type="button" class="btn btn-success  pull-right" data-toggle="modal"
                  data-target="#myModal">Add Pub Data</button>
               </h2>
                  
            {%with messages = get_flashed_messages()%}
            {%if messages%}
            {% for message in messages %}
            <div class="alert alert-success alert-dismissable" role="alert">
               <button type="button" class="close" data-dismiss="alert" aria-label="close">
                  <span aria-hidden="true">&times;</span>
               </button>
               {{message}}
            </div>
            {%endfor%}
            {%endif%}
            {%endwith%}
            <table class="table table-striped table-hover">
               <tr>
                  <th>File Pub</th>
                  <th>Duree</th>
                  <th>Frequence</th>
                  <th>Date Debut</th>
                  <th>Date Fin</th>
                  <th>Prix for one day( ~ DT)</th>
               </tr>
               {% for row in pubs %}
               {%if row.9 == "image" %}
               <tr>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     <img src="/static/{{row.7}}" alt="Your Image" width="350" height="280" />
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.1}}
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.2}}
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.3}}
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.4}}
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.5}}
                  </td>
                  <td>
                     <a href="/update/{{row.0}}" class="btn btn-warning btn-xs" data-toggle="modal"
                        data-target="#modaledit{{row.0}}">Edit</a>
                     <a href="/delete/{{ row.0 }}" class="btn btn-danger btn-xs"
                        onclick="return confirm('Are You Sure For Delete?')">Delete</a>
                  </td>
               </tr>
               {%endif%}
               {%if row.9 == "video" %}
               <tr>
                  <td>
                     <video controls autoplay width="350" height="280" controls>
                        <source src="/static/{{row.7}}">
                     </video>
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.1}}
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.2}}
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.3}}
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.4}}
                  </td>
                  <td data-toggle="modal" data-target="#modalshow{{row.0}}">
                     {{row.5}}
                  </td>
                  <td>
                     <a href="/update/{{row.0}}" class="btn btn-warning btn-xs" data-toggle="modal"
                        data-target="#modaledit{{row.0}}">Edit</a>
                     <a href="/delete/{{ row.0 }}" class="btn btn-danger btn-xs"
                        onclick="return confirm('Are You Sure For Delete?')">Delete</a>
                  </td>
               </tr>
               {%endif%}
               <div id="modaledit{{row.0}}" class="modal fade" role="dialog">
                  <div class="modal-dialog">
                     <div class="modal-content">
                        <div class="modal-header">
                           <button type="button" class="close" data-dismiss="modal">&times;</button>
                           <h4 class="modal-title">Update Information</h4>
                        </div>
                        <div class="modal-body">
                           <form action="{{ url_for('update') }}" method="POST" enctype=multipart/form-data>
                              <div class="form-group">
                                 <label>Duree </label>
                                 <input type="hidden" name="idImage" value="{{row.0}}">
                                 <input type="text" class="form-control" name="duree" value="{{row.1}}">
                              </div>
                              <div class="form-group">
                                 <label>Frequence </label>
                                 <input type="text" class="form-control" name="frequence" value="{{row.2}}">
                              </div>
                              <div class="form-group">
                                 <label>Date Debut </label>
                                 <input type="date" class="form-control" name="dateDebut" value="{{row.3}}">
                              </div>
                              <div class="form-group">
                                 <label>Date Fin </label>
                                 <input type="date" class="form-control" name="dateFin" value="{{row.4}}">
                              </div>
                              <div class="form-group">
                                 <label>Pub </label>
                                 <input type="file" class="form-control" name="fileImage" value="{{row.7}}">
                              </div>
                              <div class="form-group">
                                 <button class="btn btn-primary" type="sbumit">Update</button>
                              </div>
                           </form>
                        </div>
                        <div class="modal-footer">
                           <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                     </div>
                  </div>
               </div>
               
               <div id="modalshow{{row.0}}" class="modal fade" role="dialog">
                  <div class="modal-dialog">
                     <div class="modal-content">
                        <div class="modal-header">
                           <button type="button" class="close" data-dismiss="modal">&times;</button>
                           <h4 class="modal-title">Claim</h4>
                        </div>
                        <div class="modal-body">
                           <form enctype=multipart/form-data>
                              <div class="form-group">
                                 <label>Duree </label>
                                 <p type="text" name="duree"> {{row.1}} </p>
                                 {%for ln in recls%}
                                    {%if row.0 == ln.1%}
                                    <p style="text-align:right;" type="text" name="recl">
                                       <label>Statut : </label>
                                       {{ln.0}}      
                                    </p>
                                    {%endif%}
                                 {%endfor%}
                                 {%if row.9 == "image" %}
                                 <img style="float:right;" src="/static/{{row.7}}" alt="Your Image" width="300" height="180" />
                                 {%endif%}
                                 {%if row.9 == "video" %}
                                 <video style="float:right;" controls autoplay width="300" height="180" controls>
                                    <source src="/static/{{row.7}}">
                                 </video>
                                 {%endif%}
                              </div>
                              <div class="form-group">
                                 <label>Frequence </label>
                                 <p type="text" name="frequence"> {{row.2}} </p>
                              </div>
                              <div class="form-group">
                                 <label>Date Debut </label>
                                 <p type="date" name="dateDebut" > {{row.3}} </p>
                              </div>
                              <div class="form-group">
                                 <label>Date Fin </label>
                                 <p type="date" name="dateFin" > {{row.4}} </p>
                              </div>
                           </form>
                        </div>
                        <div class="modal-footer">
                           <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                     </div>
                  </div>
               </div>
               {% endfor %}
            </table>
         </div>
         <!-- Modal -->
         <div id="myModal" class="modal fade" role="dialog">
            <div class="modal-dialog">
               <div class="modal-content">
                  <div class="modal-header">
                     <button type="button" class="close" data-dismiss="modal">&times;</button>
                     <h4 class="modal-title">Please Insert Data</h4>
                  </div>
                  <div class="modal-body">
                     <form action="{{ url_for('insert') }}" method="POST" enctype=multipart/form-data>
                        <div class="form-group">
                           <label>Duree (Duration only for photo):</label>
                           <input type="text" class="form-control" name="duree" value="0">
                        </div>
                        <div class="form-group">
                           <label>Frequence </label>
                           <input type="text" class="form-control" name="frequence" required="1">
                        </div>
                        <div class="form-group">
                           <label>Date Debut </label>
                           <input type="date" class="form-control" name="dateDebut" required="1"
                              placeholder=" Date Debut">
                        </div>
                        <div class="form-group">
                           <label>Date Fin </label>
                           <input type="date" class="form-control" name="dateFin" required="1" placeholder=" Date Fin">
                        </div>
                        <div class="form-group">
                           <label>Pub </label>
                           <input type="file" class="form-control" name="fileImage" autocomplete="off" required="1">
                        </div>
                        <div class="form-group">
                           <button class="btn btn-primary" type="submit">Insert Data</button>
                        </div>
                     </form>
                  </div>
                  <div class="modal-footer">
                     <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
   <hr><br>
{% endblock %}
